# 分布式系统的可靠性和容错性
- 系统中个别元素的错误是不可避免的
- Reliability > Availability，不仅要可用，还需要符合用户预期
- 容错技术可以用于提升 Reliability Availability

## Availability, reliability, and state
- 在分布式系统中，最基本的容错手段就是冗余
  - Availability 场景，允许服务停止并重启，类似于给汽车换轮胎
  - reliability 场景，需要保证服务的连续性，类似飞机引擎
  - 与之相对应，无状态应用需要保证 available ，有状态应用需要保证 reliability
  
## 把 failure 看成理所当然的事
- 这段提到了在计算机世界中 failure 不是二元的，更像是健康程度这种，而不是只有健康非健康两种状态
- 感觉这段中提出的对工程师的要求很高，很多故障只有经历才能明白，所以工程师经验丰富也很重要。
> 每个潜在的故障都必须被识别和分类，并且必须能够迅速补救，或者通过广泛的测试和健壮的设计决策来避免。设计容错系统的核心挑战是理解故障的本质，以及如何检测和纠正故障，特别是在部分故障或间歇性故障时，以尽可能有效地继续为用户提供服务。


## 无状态应用
- 需要保证任何 failure 都有统计独立性，意思就是错误之间是独立的，这样才能通过增加冗余资源来提高可用性
- 如何提升失败的统计独立性
  - 例如，把服务实例放在不同地理区域的不同可用区内。
  - 使用一系列措施来确保客户请求在任何时候都可以路由到被认为运行良好且服务可用的区域。此路由最好是到最近的区域，但当最近的区域无法提供服务时，必须能够路由到非本地区域。
  
## 有状态应用
- 几个9是用来描述 Availability 的

### 架构上的设计来达到 Reliability
- Stateful role placement
  - 中文不知道怎么翻译，大意就是因为是有状态的，所以分配资源要保证一致，例如一次会话的不同调用需要分配到同一个资源上
  - 用了一致性哈希
- 检测到失败，重新哈希，继续执行
  - 要保证状态的连续，感觉又牵扯到一致性这个问题了
- 消息持久化

# 结论
- 感觉 Reliability 就是 Availability 加上一定程度的一致性
- 其实描述的和 CAP 差不多，只是从工程角度来聊分布系统中存在的问题。
- 系统能无状态最好还是无状态
  
